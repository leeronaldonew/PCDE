function Ct=TTCM_analytic_Multi_GPU(PL,PI_Time_fine,Local_Estimates) 
%% CPU speed ==> 0.58 [sec] per row ==> 148.48 [sec] per Slice
%% GPU speed ==> ?


coder.gpu.kernelfun();
Ct=coder.nullcopy( zeros(size(PL,1),size(PI_Time_fine,2),'half') );
Ct=( ((PL(:,1).*((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-PL(:,4))-PL(:,1).*PL(:,3))./((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-(((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2))) .* (((Local_Estimates(1)./((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(2))).*(exp(-1.*Local_Estimates(2).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(3)./((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(4))).*(exp(-1.*Local_Estimates(4).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(5)./((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(6))).*(exp(-1.*Local_Estimates(6).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(7)./((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(8))).*(exp(-1.*Local_Estimates(8).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine)))) ) + ( ((PL(:,1).*PL(:,3)-(PL(:,1).*((((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-PL(:,4))))./((((PL(:,2)+PL(:,3)+PL(:,4)) + (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-(((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2))) .* (((Local_Estimates(1)./((((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(2))).*(exp(-1.*Local_Estimates(2).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(3)./((((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(4))).*(exp(-1.*Local_Estimates(4).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(5)./((((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(6))).*(exp(-1.*Local_Estimates(6).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(7)./((((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2)-Local_Estimates(8))).*(exp(-1.*Local_Estimates(8).*PI_Time_fine)-exp(-1.*(((PL(:,2)+PL(:,3)+PL(:,4)) - (((PL(:,2)+PL(:,3)+PL(:,4)).^2)-(4.*PL(:,2).*PL(:,4))).^(0.5) ) ./ 2).*PI_Time_fine)))) );

%Ct(isnan(Ct))=0; % removing NaN

end