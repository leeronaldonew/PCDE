function C_tot=TTCM_analytic_Multi_Speedy(PL_300,PI_Time_fine,Local_Estimates) 

%coder.gpu.kernelfun();
%Num_t=size(PI_Time_fine,2);
%Num_TACs=size(PL_300,1);
%C_tot=zeros(Num_TACs,Num_t,'single');
%for TAC=1:1:Num_TACs
%    for t=1:1:Num_t
%        C_tot(TAC,t)=( ((PL_300(TAC,1).*((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-PL_300(TAC,4))-PL_300(TAC,1).*PL_300(TAC,3))./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2))) .* (((Local_Estimates(1)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(2))).*(exp(-1.*Local_Estimates(2).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t)))) + ((Local_Estimates(3)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(4))).*(exp(-1.*Local_Estimates(4).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t)))) + ((Local_Estimates(5)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(6))).*(exp(-1.*Local_Estimates(6).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t)))) + ((Local_Estimates(7)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(8))).*(exp(-1.*Local_Estimates(8).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t))))) ) + ( ((PL_300(TAC,1).*PL_300(TAC,3)-(PL_300(TAC,1).*((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-PL_300(TAC,4))))./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) + (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2))) .* (((Local_Estimates(1)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(2))).*(exp(-1.*Local_Estimates(2).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t)))) + ((Local_Estimates(3)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(4))).*(exp(-1.*Local_Estimates(4).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t)))) + ((Local_Estimates(5)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(6))).*(exp(-1.*Local_Estimates(6).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t)))) + ((Local_Estimates(7)./((((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2)-Local_Estimates(8))).*(exp(-1.*Local_Estimates(8).*PI_Time_fine(1,t))-exp(-1.*(((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)) - (((PL_300(TAC,2)+PL_300(TAC,3)+PL_300(TAC,4)).^2)-(4.*PL_300(TAC,2).*PL_300(TAC,4))).^(0.5) ) ./ 2).*PI_Time_fine(1,t))))) );
%    end
%end

C_tot=( ((PL_300(:,1).*((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-PL_300(:,4))-PL_300(:,1).*PL_300(:,3))./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2))) .* (((Local_Estimates(1)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(2))).*(exp(-1.*Local_Estimates(2).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(3)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(4))).*(exp(-1.*Local_Estimates(4).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(5)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(6))).*(exp(-1.*Local_Estimates(6).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(7)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(8))).*(exp(-1.*Local_Estimates(8).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine)))) ) + ( ((PL_300(:,1).*PL_300(:,3)-(PL_300(:,1).*((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-PL_300(:,4))))./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) + (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2))) .* (((Local_Estimates(1)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(2))).*(exp(-1.*Local_Estimates(2).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(3)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(4))).*(exp(-1.*Local_Estimates(4).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(5)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(6))).*(exp(-1.*Local_Estimates(6).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine))) + ((Local_Estimates(7)./((((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2)-Local_Estimates(8))).*(exp(-1.*Local_Estimates(8).*PI_Time_fine)-exp(-1.*(((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)) - (((PL_300(:,2)+PL_300(:,3)+PL_300(:,4)).^2)-(4.*PL_300(:,2).*PL_300(:,4))).^(0.5) ) ./ 2).*PI_Time_fine)))) );
C_tot(isnan(C_tot))=0; % removing NaN

end